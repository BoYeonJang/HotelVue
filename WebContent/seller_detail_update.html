<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>호텔컴바인닷컴 :: 판매자 호텔 정보 수정</title>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.js"></script>
<link rel="icon" href="./img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="./css/header.css">
</head>
<body>
	<div id="app">
		<header>
			<div class="nav">
				<ul v-if="empty">
					<li class="hotel"><a href="./index.html"> <img
							src="./img/title/hotelcombine.com.png">
					</a></li>
					<li class="login" style="float: right"><a
						href="./login_member.html">로그인</a></li>
					<li class="login" style="float: right"><a
						href="./register_member.html">회원가입</a></li>
				</ul>
				<ul v-else>
					<li class="hotel"><a href="./index.html"> <img
							src="./img/title/hotelcombine.com.png">
					</a></li>
					<li class="logout" style="float: right" :click="logout"><a
						href="./index.html" @click="logout()">로그아웃</a></li>
					<li class="logout" style="float: right"><a
						href="./member_mypage.html">마이페이지</a></li>
				</ul>
			</div>
		</header>
		<h3>호텔 세부 정보 수정</h3>
		<form action="#" method="POST" id="detail" name="detail"
			@submit.prevent="update()">
			Hotel ID : <input type="text" id="id" name="id" v-model="hotel.id"
				readonly>
			<p>
				호텔 명 : <input type="text" id="name" name="name" v-model="hotel.name">
			<p>
				호텔 위치 : <input type="text" id="location" name="location"
					v-model="hotel.location">
			<p>
				호텔 이미지 : <input type="text" id="img" name="img" v-model="hotel.img">
			<p>
				호텔 세부 설명 : <input type="text" name="description" id="description"
					v-model="hotel.description"
					style="text-align: center; width: 200px; height: 50px;">
			<p>
				<button type="submit">수정 완료</button>
		</form>
		
		<footer>
			<div class="footer">
				<table>
					<tr>
						<td><a href="./team.html">팀 소개</a></td>
						<td><a href="https://github.com/BoYeonJang/HotelVue">Front-end
								깃 주소</a></td>
						<td><a href="https://github.com/BoYeonJang/Hotel">Back-End
								깃 주소</a></td>
					</tr>
					<tr class="footer_img_center">
						<td colspan="3"><a href="./index.html"><img
								src="./img/title/hotelcombine.com.png"></a></td>
					</tr>
				</table>
			</div>
		</footer>
	</div>
	<script>
	var app = new Vue({
        el: '#app',
        data() {
            return {
                loading: true,
                errored: false,
                empty: localStorage.getItem('loginId') == null,
                member : {},
                hotel : {},
            }
        },
        mounted() {
        	this.initMember();
        },
        methods: {
        	initMember() {
        		axios
				.get("http://localhost:8888/findMemberById/" + localStorage.getItem('loginId'))
				.then(response => {
					this.member = response.data;
					if (response.data.hotelId != null){
						this.getHotel()
					}
				})
				.catch(error =>{
					console.log(error);
					this.errored=true;
				})
				.finally(()=> this.loading =false)
        	},
        	getHotel() {
        		axios
				.get("http://localhost:8888/findHotelById/" + this.member.hotelId)
				.then(response => {
					this.hotel = response.data;
				})
				.catch(error =>{
					console.log(error);
					this.errored=true;
				})
				.finally(()=> this.loading =false)
        	},
            update() {
				axios
				.put("http://127.0.0.1:8888/updateHotel", {
					id : this.hotel.id,
					name:document.getElementById('name').value,
					location:document.getElementById('location').value,
					img:document.getElementById('img').value,
					description:document.getElementById('description').value,
				})
				.then(function(response) {
				//alert(app.cname+'님이 등록되었습니다.');
				alert(`${app.hotel.name}호텔 정보를 수정하였습니다.`);
				location.href = "./index.html";
				})
			},
			logout() {
                localStorage.clear();
                location.href = './index.html'
            }
		}
	})
	
	</script>
</body>
</html>